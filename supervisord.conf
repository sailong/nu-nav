[supervisord]
nodaemon=true
user=root

[program:backend]
directory=/app/backend
# 先迁移数据库，再执行种子数据(创建默认账号)，最后启动服务
command=sh -c "npx prisma migrate deploy --schema ./prisma/schema.prisma && node seed.js && npm start"
autostart=true
autorestart=true
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0

[program:nginx]
command=nginx -g "daemon off;"
autostart=true
autorestart=true
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
